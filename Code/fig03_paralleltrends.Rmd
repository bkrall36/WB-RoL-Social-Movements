---
title: "fig03_paralleltrends"
author: "Brendon Krall"
date: "2022-09-01"
output: html_document
---

# Parallel Trend Graphs
```{r, warning=FALSE, echo=False}
# Subset data for ease of manipulation
df_subset <- df %>% select(c(Year, Vote_Share.1, 'Party Initials', treated))

# Rename for clarity
df_subset <- df_subset %>%
  mutate(
    treated = ifelse(treated == 1, 'Visited', 'Never Visted')
)

# Parallel Trend for PML                    
df_subset %>%
  filter((`Party Initials` == 'PML') & (Year >= 1997)) %>%
  ggplot(aes(x = Year, y = Vote_Share.1, color = treated)) +
  stat_summary(fun.y = mean, geom = 'line', size = 1.25) +
  theme_bw() +
  labs(x = "Year", y = "% of Vote Share", title = "Evolution of Vote Share - PML (Years 1997 to 2012)") +
  geom_vline(xintercept = 2007) +
  scale_color_manual('Treated', values = c("Visited" = "#2F4F4F", "Never Visited" = "#DCDCDC")) +
  theme(legend.position="bottom", legend.title=element_blank(), plot.title = element_text(hjust = 0.5))

# Parallel Trend for PML-N                   
df_subset %>%
  filter((`Party Initials` == 'PML-N') & (Year >= 1997)) %>%
  ggplot(aes(x = Year, y = Vote_Share.1, color = treated)) +
  stat_summary(fun.y = mean, geom = 'line', size = 1.25) +
  theme_bw() +
  labs(x = "Year", y = "% of Vote Share", title = "Evolution of Vote Share - PML-N (Years 1997 to 2012)") +
  geom_vline(xintercept = 2007) +
  scale_color_manual('Treated', values = c("Visited" = "#2F4F4F", "Never Visited" = "#DCDCDC")) +
  theme(legend.position="bottom", legend.title=element_blank(), plot.title = element_text(hjust = 0.5))

# Parallel Trend for PPPP                    
df_subset %>%
  filter(`Party Initials` == 'PPPP') %>%
  ggplot(aes(x = Year, y = Vote_Share.1, color = treated)) +
  stat_summary(fun.y = mean, geom = 'line', size = 1.25) +
  theme_bw() +
  labs(x = "Year", y = "% of Vote Share", title = "Evolution of Vote Share - PPP (Years 2002 to 2012)") +
  geom_vline(xintercept = 2007) +
  scale_color_manual('Treated', values = c("Visited" = "#2F4F4F", "Never Visited" = "#DCDCDC")) +
  theme(legend.position="bottom", legend.title=element_blank(), plot.title = element_text(hjust = 0.5))
```